(function(e,t){"use strict";window.wp=window.wp||{},wp.ccf=wp.ccf||{},wp.ccf.validators=wp.ccf.validators||{};var i={},l=_.noConflict();window.ccfRecaptchaOnload=function(){for(var e=document.querySelectorAll(".ccf-recaptcha-wrapper"),l=function(l){grecaptcha.render(e[s],{sitekey:e[s].getAttribute("data-sitekey"),theme:t.recaptcha_theme,callback:function(){i[l]=!0}})},s=0;e.length>s;s++){var r=e[s].getAttribute("data-form-id");l(r)}};var s=function(e){if(this.wrapper=e,this.errors={},e.className.match(" field-required")){this.inputs=this.wrapper.querySelectorAll(".field-input");var i=this.wrapper.querySelectorAll(".error");i.length&&i[0].parentNode.removeChild(i[0]);var s=!1;if(l.each(this.inputs,function(e){(e.checked&&e.value||e.selected)&&(s=!0)}),!s){this.errors[this.inputs[this.inputs.length-1].getAttribute("name")]={required:!0};var r=document.createElement("div");r.className="error required-error",r.innerHTML=t.required,e.appendChild(r)}}},r=function(e,i){return function(s){this.wrapper=s,this.inputs=this.wrapper.querySelectorAll(".field-input"),this.errors={};for(var r=this.wrapper.querySelectorAll(".error"),o=r.length-1;o>=0;o--)r[o].parentNode.removeChild(r[o]);l.each(this.inputs,function(t){var i=t.getAttribute("name");this.errors[i]={},t.getAttribute("aria-required")&&""===t.value&&(this.errors[i].required=t),e&&e.call(this,t)},this),i&&i.call(this);var n;for(var c in this.errors)if(this.errors.hasOwnProperty(c))for(var a in this.errors[c])n=document.createElement("div"),n.className="error "+a+"-error",n.setAttribute("data-field-name",c),n.innerHTML=t[a],this.errors[c][a].parentNode.insertBefore(n,this.errors[c][a].nextSibling)}};wp.ccf.validators["single-line-text"]=wp.ccf.validators["single-line-text"]||r(),wp.ccf.validators["paragraph-text"]=wp.ccf.validators["paragraph-text"]||r(),wp.ccf.validators.name=wp.ccf.validators.name||r(),wp.ccf.validators.email=wp.ccf.validators.email||r(!1,function(){var e=this.inputs[0].value;if(e){2===this.inputs.length&&e!==this.inputs[1].value&&(this.errors[this.inputs[0].getAttribute("name")].match=this.wrapper.lastChild);var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;t.test(e)||(this.errors[this.inputs[0].getAttribute("name")].email=this.wrapper.lastChild)}}),wp.ccf.validators.recaptcha=wp.ccf.validators.recaptcha||function(e,l){this.wrapper=e,this.inputs=this.wrapper.querySelectorAll(".g-recaptcha-response"),this.errors={};for(var s=this.wrapper.querySelectorAll(".error"),r=s.length-1;r>=0;r--)s[r].parentNode.removeChild(s[r]);i[l]||(this.errors["g-recaptcha-response"]={},this.errors["g-recaptcha-response"].recaptcha=this.wrapper.lastChild);var o;for(var n in this.errors)if(this.errors.hasOwnProperty(n))for(var c in this.errors[n])o=document.createElement("div"),o.className="error "+c+"-error",o.setAttribute("data-field-name",n),o.innerHTML=t[c],this.errors[n][c].parentNode.insertBefore(o,this.errors[n][c].nextSibling)},wp.ccf.validators["simple-captcha"]=wp.ccf.validators["simple-captcha"]||r(function(){}),wp.ccf.validators.phone=wp.ccf.validators.phone||r(!1,function(){var e=this.inputs[0].value;if(e){var t=/^[0-9+.)(\- ]+$/;if(t.test(e)){if("us"===this.wrapper.getAttribute("data-phone-format")){var i=e.replace(/[^0-9]/gi,"");10!==i.length&&(this.errors[this.inputs[0].getAttribute("name")].digits=this.wrapper.lastChild)}}else this.errors[this.inputs[0].getAttribute("name")].phone=this.wrapper.lastChild}}),wp.ccf.validators.date=wp.ccf.validators.date||function(e){this.wrapper=e,this.errors={},this.inputs=this.wrapper.querySelectorAll(".field-input");for(var i=this.wrapper.querySelectorAll(".error"),s=i.length-1;s>=0;s--)i[s].parentNode.removeChild(i[s]);var r;l.each(this.inputs,function(i){var l=i.getAttribute("name");if(this.errors[l]={},i.getAttribute("aria-required")&&""===i.value&&(this.errors[l].required=!0,r=document.createElement("div"),r.className="error required-error",1===this.inputs.length?(r.innerHTML=t.required,r.className+=" right-error",i.parentNode.insertBefore(r,i.nextSibling)):(r.innerHTML=t[l.replace(/.*\[(.*?)\]/i,"$1")+"_required"],e.appendChild(r))),""!==i.value){var s=l.replace(/^.*\[(.*?)\]$/,"$1");"date"===s?i.value.match(/^([0-9]|\/)+$/)||(r=document.createElement("div"),r.className="error date-error",r.innerHTML=t.date,e.appendChild(r)):"hour"===s?i.value.match(/^[0-9]+$/)||(r=document.createElement("div"),r.className="error hour-error",r.innerHTML=t.hour,e.appendChild(r)):"minute"===s&&(i.value.match(/^[0-9]+$/)||(r=document.createElement("div"),r.className="error minute-error",r.innerHTML=t.minute,e.appendChild(r)))}},this)},wp.ccf.validators.address=wp.ccf.validators.address||r(),wp.ccf.validators.file=wp.ccf.validators.file||function(e){this.wrapper=e,this.inputs=this.wrapper.querySelectorAll(".field-input"),this.errors={};for(var i=this.wrapper.querySelectorAll(".error"),s=i.length-1;s>=0;s--)i[s].parentNode.removeChild(i[s]);l.each(this.inputs,function(e){var t=e.getAttribute("name");this.errors[t]={},e.getAttribute("aria-required")&&""===e.value&&(this.errors[t].required=e)},this);var r=this.inputs[0],o=this.wrapper.getAttribute("data-max-file-size"),n=this.wrapper.getAttribute("data-file-extensions");if(r.value){if(o){var c=1e3*1e3*parseInt(o);if(r.files)r.files[0].size>c&&(this.errors[this.inputs[0].getAttribute("name")].fileSize=this.wrapper.lastChild);else if("undefined"!=typeof ActiveXObject)try{var a=new ActiveXObject("Scripting.FileSystemObject"),d=a.getFile(r.value);d.size>c&&(this.errors[this.inputs[0].getAttribute("name")].fileSize=this.wrapper.lastChild)}catch(f){}}if(n){var u=n.replace(";",",").toLowerCase();if(u=u.replace(/\s+/g,""),u=u.split(","),u.length){var p=r.value.replace(/^.*\.(.+)$/g,"$1").toLowerCase();-1===l.indexOf(u,p)&&(this.errors[this.inputs[0].getAttribute("name")].fileExtension=this.wrapper.lastChild)}}}var h;for(var m in this.errors)if(this.errors.hasOwnProperty(m))for(var w in this.errors[m])h=document.createElement("div"),h.className="error "+w+"-error",h.setAttribute("data-field-name",m),h.innerHTML=t[w],"fileExtension"===w&&n?h.innerHTML+=" ("+n+")":"fileSize"===w&&o&&(h.innerHTML+=" "+o+" MB"),this.errors[m][w].parentNode.insertBefore(h,this.errors[m][w].nextSibling)},wp.ccf.validators.website=wp.ccf.validators.website||r(function(e){if(e.value){var t=/^http(s?)\:\/\/(([a-zA-Z0-9\-\._]+(\.[a-zA-Z0-9\-\._]+)+)|localhost)(\/?)([a-zA-Z0-9\-\.\?\,\'\/\\\+&amp;%\$#_]*)?([\d\w\.\/\%\+\-\=\&amp;\?\:\\\&quot;\'\,\|\~\;]*)$/;t.test(e.value)||(this.errors[e.getAttribute("name")].website=e)}}),wp.ccf.validators.checkboxes=wp.ccf.validators.checkboxes||s,wp.ccf.validators.dropdown=wp.ccf.validators.dropdown||r(),wp.ccf.validators.radio=wp.ccf.validators.radio||s,wp.ccf.setupDOM=wp.ccf.setupDOM||function(){for(var s,r,o=document.querySelectorAll(".ccf-datepicker"),n=0;o.length>n;n++)s={},r=o[n].getAttribute("data-date-format"),r&&(s.dateFormat=r.replace(/yyyy/i,"yy")),e(o[n]).datepicker(s);var c=document.querySelectorAll(".ccf-form-wrapper");c.length>=1&&l.each(c,function(s){function r(t){var i=[];if(l.each(h,function(e){if(!e.className.match(/ skip-field/i)){var t=e.getAttribute("data-field-type");e.getAttribute("data-field-slug");var s=new wp.ccf.validators[t](e,c);if(l.size(s.errors)){var r=0;for(var o in s.errors)s.errors.hasOwnProperty(o)&&l.size(s.errors[o])&&r++;r>0&&i.push(s)}}}),!i.length)return n.trigger("ccfFormSuccess"),s.className=s.className.replace(/ loading/i,"")+" loading",f.animate({opacity:100}),!0;t.returnFalse=!1,t.preventDefault&&t.preventDefault(),n.trigger("ccfFormError",i);var r=e(window).scrollTop(),o=r+e(window).height(),a=e(i[0].wrapper),d=a.offset(),u=d.top,p=u+a.height();return u>=r&&o>=p||e("html, body").animate({scrollTop:a.offset().top},500),!1}var o=s.querySelectorAll(".ccf-form")[0],n=e(o),c=parseInt(s.getAttribute("data-form-id")),a=o.querySelectorAll(".ccf-submit-button")[0],d=document.getElementById("ccf_form_frame_"+c),f=e(o.querySelectorAll(".loading-img")[0]),u=e(d),p=e(a),h={};u.on("load",function(){var s,r=u.contents().find("body").text();if(!r)return!1;o.className=o.className.replace(/ loading/i,""),f.animate({opacity:0}),i[c]=!1;try{s=e.parseJSON(r)}catch(n){var d=document.createElement("div");return d.className="error unknown-error",d.innerText=t.unknown,a.parentNode.appendChild(d),!1}var p=a.parentNode.querySelectorAll(".error");if(p.length&&p[0].parentNode.removeChild(p[0]),s.success)if("text"===s.action_type&&s.completion_message){o.innerHTML="";var m=document.createElement("div");m.innerHTML=s.completion_message,m.className="ccf-form-complete",o.appendChild(m),e("html, body").animate({scrollTop:e(o).offset().top},500)}else"redirect"===s.action_type&&s.completion_redirect_url&&(document.location=s.completion_redirect_url);else s.field_errors&&l.each(s.field_errors,function(e,t){var i=h[t].querySelectorAll(".field-input");for(var l in e)if(e.hasOwnProperty(l)){var s=document.createElement("div");s.className="error "+l+"-error",s.innerHTML=e[l],1===i.length?i[i.length-1].parentNode.insertBefore(s,i[i.length-1].nextSibling):h[t].appendChild(s)}})}),p.on("click",function(e){return e.preventDefault(),o.target="ccf_form_frame_"+c,n.submit(),!1});var m=s.querySelectorAll(".field");l.each(m,function(e){var t=e.getAttribute("data-field-slug");h[t]=e}),l.each(m,function(t){var i=t.getAttribute("data-field-slug"),s=t.getAttribute("data-field-type");if(wp.ccf.conditionals[c][i]&&wp.ccf.conditionals[c][i].conditions.length){var r=wp.ccf.conditionals[c][i].conditionalType,o=wp.ccf.conditionals[c][i].conditionalFieldsRequired;wp.ccf.conditionals[c][i].trigger=function(){var n;"any"===o?(n=!1,l.each(wp.ccf.conditionals[c][i].conditions,function(e){e.state&&(n=!0)})):(n=!0,l.each(wp.ccf.conditionals[c][i].conditions,function(e){n=n&&e.state})),"hide"===r&&(n=!n),n?"section-header"===s?e(t).parents(".ccf-section").removeClass("field-hide"):t.className=t.className.replace(/field-hide/i,""):"section-header"===s?e(t).parents(".ccf-section").addClass("field-hide"):t.className=t.className.replace(/field-hide/i,"")+" field-hide"},l.each(wp.ccf.conditionals[c][i].conditions,function(t){function s(e){"is"===t.compare?t.state=e===t.value?!0:!1:"is-not"===t.compare?t.state=e!==t.value?!0:!1:"greater-than"===t.compare?t.state=parseInt(e)>parseInt(t.value)?!0:!1:"less-than"===t.compare?t.state=parseInt(e)<parseInt(t.value)?!0:!1:"contains"===t.compare&&(t.state=e.match(t.value)?!0:!1)}var r=h[t.field].querySelectorAll(".field-input");e(r).on("change keyup",l.debounce(function(e){s(e.currentTarget.value),wp.ccf.conditionals[c][i].trigger()},250)),s(r.value),wp.ccf.conditionals[c][i].trigger()})}}),n.on("submit",r)})},e(document).ready(wp.ccf.setupDOM)})(jQuery,ccfSettings);